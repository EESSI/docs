
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://eessi.github.io/docs/test-suite/ReFrame-configuration-file/">
      
      
        <link rel="prev" href="../installation-configuration/">
      
      
        <link rel="next" href="../usage/">
      
      
      <link rel="icon" href="../../img/logos/EESSI.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.25">
    
    
      
        <title>ReFrame configuration file - European Environment for Scientific Software Installations (EESSI)</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6543a935.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#reframe-config-file" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="European Environment for Scientific Software Installations (EESSI)" class="md-header__button md-logo" aria-label="European Environment for Scientific Software Installations (EESSI)" data-md-component="logo">
      
  <img src="../../img/logos/EESSI.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            European Environment for Scientific Software Installations (EESSI)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ReFrame configuration file
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/EESSI" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    EESSI @ GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="European Environment for Scientific Software Installations (EESSI)" class="md-nav__button md-logo" aria-label="European Environment for Scientific Software Installations (EESSI)" data-md-component="logo">
      
  <img src="../../img/logos/EESSI.png" alt="logo">

    </a>
    European Environment for Scientific Software Installations (EESSI)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/EESSI" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    EESSI @ GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Design
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Design
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Project overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../filesystem_layer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Filesystem layer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../compatibility_layer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Compatibility layer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../software_layer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Software layer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../software_layer/cpu_targets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Supported CPU targets
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Installation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Installation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_access/is_eessi_accessible/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Is EESSI already installed?
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_access/native_installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Native
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_access/eessi_container/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Container
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Basic usage
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Basic usage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../using_eessi/setting_up_environment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Set up environment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../using_eessi/basic_commands/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic commands
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../using_eessi/eessi_demos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Demos
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../available_software/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Available software
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Advanced usage
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Advanced usage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
        
          
          <label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Repositories
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            Repositories
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../repositories/software.eessi.io/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Production
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../repositories/riscv.eessi.io/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RISC-V
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../repositories/pilot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pilot
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../filesystem_layer/stratum1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setting up your Stratum
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../using_eessi/building_on_eessi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building software with EESSI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4" checked>
        
          
          <label class="md-nav__link" for="__nav_6_4" id="__nav_6_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Test suite
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6_4">
            <span class="md-nav__icon md-icon"></span>
            Test suite
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation-configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation & configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    ReFrame configuration file
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    ReFrame configuration file
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#available-reframe-configuration-file" class="md-nav__link">
    <span class="md-ellipsis">
      Available ReFrame configuration file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verifying-your-reframe-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Verifying your ReFrame configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-write-a-reframe-configuration-file" class="md-nav__link">
    <span class="md-ellipsis">
      How to write a ReFrame configuration file
    </span>
  </a>
  
    <nav class="md-nav" aria-label="How to write a ReFrame configuration file">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#python-imports" class="md-nav__link">
    <span class="md-ellipsis">
      Python imports
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#high-level-system-info-systems" class="md-nav__link">
    <span class="md-ellipsis">
      High-level system info (systems)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#partitions" class="md-nav__link">
    <span class="md-ellipsis">
      System partitions (systems.partitions)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environments" class="md-nav__link">
    <span class="md-ellipsis">
      Environments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logging" class="md-nav__link">
    <span class="md-ellipsis">
      Logging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cpu-auto-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Auto-detection of processor information
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../available-tests/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Available tests
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../release-notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release notes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_5" >
        
          
          <label class="md-nav__link" for="__nav_6_5" id="__nav_6_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Accelerators support
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_5">
            <span class="md-nav__icon md-icon"></span>
            Accelerators support
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gpu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GPUs
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Adding software to EESSI
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Adding software to EESSI
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../adding_software/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    For contributors
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            For contributors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../adding_software/contribution_policy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contribution policy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../adding_software/opening_pr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Open PR
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../adding_software/debugging_failed_builds/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Debugging
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3" >
        
          
          <label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    For maintainers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3">
            <span class="md-nav__icon md-icon"></span>
            For maintainers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BTD bot
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../adding_software/building_software/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building software
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../adding_software/deploying_software/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deploying software
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../software_layer/build_nodes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Build nodes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Known issues
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Known issues
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../known_issues/eessi-2023.06/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    v2023.06
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    v2022.02
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pilot
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Community and support
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Community and support
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../support/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting support
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../meetings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Meetings
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../talks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Talks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contact/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contact info
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../blog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blog
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#available-reframe-configuration-file" class="md-nav__link">
    <span class="md-ellipsis">
      Available ReFrame configuration file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#verifying-your-reframe-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Verifying your ReFrame configuration
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-write-a-reframe-configuration-file" class="md-nav__link">
    <span class="md-ellipsis">
      How to write a ReFrame configuration file
    </span>
  </a>
  
    <nav class="md-nav" aria-label="How to write a ReFrame configuration file">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#python-imports" class="md-nav__link">
    <span class="md-ellipsis">
      Python imports
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#high-level-system-info-systems" class="md-nav__link">
    <span class="md-ellipsis">
      High-level system info (systems)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#partitions" class="md-nav__link">
    <span class="md-ellipsis">
      System partitions (systems.partitions)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environments" class="md-nav__link">
    <span class="md-ellipsis">
      Environments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logging" class="md-nav__link">
    <span class="md-ellipsis">
      Logging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cpu-auto-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Auto-detection of processor information
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="reframe-config-file">ReFrame configuration file<a class="headerlink" href="#reframe-config-file" title="Permanent link">&para;</a></h1>
<p>In order for ReFrame to run tests on your system, it needs to know some properties about your system.
For example, it needs to know what kind of job scheduler you have, which partitions the system has,
how to submit to those partitions, etc.
All of this has to be described in a <em>ReFrame configuration file</em> (see also the <a href="#RFM_CONFIG_FILES">section on <code>$RFM_CONFIG_FILES</code> above</a>).</p>
<p>This page is organized as follows:</p>
<ul>
<li>available ReFrame configuration file</li>
<li>Verifying your ReFrame configuration</li>
<li>How to write a ReFrame configuration file</li>
</ul>
<h2 id="available-reframe-configuration-file">Available ReFrame configuration file<a class="headerlink" href="#available-reframe-configuration-file" title="Permanent link">&para;</a></h2>
<p>There are some available ReFrame configuration files for HPC systems and public cloud in the <a href="https://github.com/EESSI/test-suite/tree/main/config/">config directory</a> for more inspiration.
Below is a simple ReFrame configuration file with minimal changes required for getting you started on using the test suite for a CPU partition. Please check that <code>stagedir</code> is set to a path on a (shared) scratch filesystem for storing (temporary) files related to the tests, and <code>access</code> is set to a list of arguments that you would normally pass to the scheduler when submitting to this partition (for example '-p cpu' for submitting to a Slurm partition called cpu).</p>
<p>To write a ReFrame configuration file for your system, check the section How to write a ReFrame configuration file.  </p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="sd">simple ReFrame configuration file</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="kn">import</span> <span class="nn">os</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="kn">from</span> <span class="nn">eessi.testsuite.common_config</span> <span class="kn">import</span> <span class="n">common_logging_config</span><span class="p">,</span> <span class="n">common_eessi_init</span><span class="p">,</span> <span class="n">format_perfvars</span><span class="p">,</span> <span class="n">perflog_format</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="kn">from</span> <span class="nn">eessi.testsuite.constants</span> <span class="kn">import</span> <span class="o">*</span>  
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="n">site_configuration</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="s1">&#39;systems&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>        <span class="p">{</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;cpu_partition&#39;</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>            <span class="s1">&#39;descr&#39;</span><span class="p">:</span> <span class="s1">&#39;CPU partition&#39;</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>            <span class="s1">&#39;modules_system&#39;</span><span class="p">:</span> <span class="s1">&#39;lmod&#39;</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>            <span class="s1">&#39;hostnames&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">],</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>            <span class="c1"># Note that the stagedir should be a shared directory available on all nodes running ReFrame tests</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>            <span class="s1">&#39;stagedir&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;/some/shared/dir/</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;USER&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">/reframe_output/staging&#39;</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>            <span class="s1">&#39;partitions&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>                <span class="p">{</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>                    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;cpu_partition&#39;</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>                    <span class="s1">&#39;descr&#39;</span><span class="p">:</span> <span class="s1">&#39;CPU partition&#39;</span><span class="p">,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>                    <span class="s1">&#39;scheduler&#39;</span><span class="p">:</span> <span class="s1">&#39;slurm&#39;</span><span class="p">,</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>                    <span class="s1">&#39;launcher&#39;</span><span class="p">:</span> <span class="s1">&#39;mpirun&#39;</span><span class="p">,</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>                    <span class="s1">&#39;access&#39;</span><span class="p">:</span>  <span class="p">[</span><span class="s1">&#39;-p cpu&#39;</span><span class="p">,</span> <span class="s1">&#39;--export=None&#39;</span><span class="p">],</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>                    <span class="s1">&#39;prepare_cmds&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;source </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">common_eessi_init</span><span class="p">()],</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>                    <span class="s1">&#39;environs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">],</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>                    <span class="s1">&#39;max_jobs&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>                    <span class="s1">&#39;resources&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>                        <span class="p">{</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>                            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;memory&#39;</span><span class="p">,</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>                            <span class="s1">&#39;options&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;--mem=</span><span class="si">{size}</span><span class="s1">&#39;</span><span class="p">],</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>                        <span class="p">}</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>                    <span class="p">],</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>                    <span class="s1">&#39;features&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>                        <span class="n">FEATURES</span><span class="p">[</span><span class="n">CPU</span><span class="p">]</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>                    <span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">SCALES</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>                <span class="p">}</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a>            <span class="p">]</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>        <span class="p">},</span>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>    <span class="p">],</span>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a>    <span class="s1">&#39;environments&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a>        <span class="p">{</span>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a>            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a>            <span class="s1">&#39;cc&#39;</span><span class="p">:</span> <span class="s1">&#39;cc&#39;</span><span class="p">,</span>
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a>            <span class="s1">&#39;cxx&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a>            <span class="s1">&#39;ftn&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a>        <span class="p">},</span>
<a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a>    <span class="p">],</span>
<a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a>    <span class="s1">&#39;logging&#39;</span><span class="p">:</span> <span class="n">common_logging_config</span><span class="p">(),</span>
<a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a>    <span class="s1">&#39;general&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a>        <span class="p">{</span>
<a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a>            <span class="c1"># Enable automatic detection of CPU architecture for each partition</span>
<a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a>            <span class="c1"># See https://reframe-hpc.readthedocs.io/en/stable/configure.html#auto-detecting-processor-information</span>
<a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a>            <span class="s1">&#39;remote_detect&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-55" name="__codelineno-0-55" href="#__codelineno-0-55"></a>        <span class="p">}</span>
<a id="__codelineno-0-56" name="__codelineno-0-56" href="#__codelineno-0-56"></a>    <span class="p">],</span>
<a id="__codelineno-0-57" name="__codelineno-0-57" href="#__codelineno-0-57"></a><span class="p">}</span>
<a id="__codelineno-0-58" name="__codelineno-0-58" href="#__codelineno-0-58"></a>
<a id="__codelineno-0-59" name="__codelineno-0-59" href="#__codelineno-0-59"></a><span class="c1"># optional logging to syslog</span>
<a id="__codelineno-0-60" name="__codelineno-0-60" href="#__codelineno-0-60"></a><span class="n">site_configuration</span><span class="p">[</span><span class="s1">&#39;logging&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;handlers_perflog&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
<a id="__codelineno-0-61" name="__codelineno-0-61" href="#__codelineno-0-61"></a>    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;syslog&#39;</span><span class="p">,</span>
<a id="__codelineno-0-62" name="__codelineno-0-62" href="#__codelineno-0-62"></a>    <span class="s1">&#39;address&#39;</span><span class="p">:</span> <span class="s1">&#39;/dev/log&#39;</span><span class="p">,</span>
<a id="__codelineno-0-63" name="__codelineno-0-63" href="#__codelineno-0-63"></a>    <span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="s1">&#39;info&#39;</span><span class="p">,</span>
<a id="__codelineno-0-64" name="__codelineno-0-64" href="#__codelineno-0-64"></a>    <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;reframe: </span><span class="si">{</span><span class="n">perflog_format</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
<a id="__codelineno-0-65" name="__codelineno-0-65" href="#__codelineno-0-65"></a>    <span class="s1">&#39;format_perfvars&#39;</span><span class="p">:</span> <span class="n">format_perfvars</span><span class="p">,</span>
<a id="__codelineno-0-66" name="__codelineno-0-66" href="#__codelineno-0-66"></a>    <span class="s1">&#39;append&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-67" name="__codelineno-0-67" href="#__codelineno-0-67"></a><span class="p">})</span>
</code></pre></div>
<h2 id="verifying-your-reframe-configuration">Verifying your ReFrame configuration<a class="headerlink" href="#verifying-your-reframe-configuration" title="Permanent link">&para;</a></h2>
<p>To verify the ReFrame configuration, you can <a href="https://reframe-hpc.readthedocs.io/en/stable/configure.html#querying-configuration-options">query the configuration using <code>--show-config</code></a>.</p>
<p>To see the full configuration, use:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>reframe<span class="w"> </span>--show-config
</code></pre></div>
<p>To only show the configuration of a particular system partition, you can use the <a href="https://reframe-hpc.readthedocs.io/en/stable/manpage.html#cmdoption-system"><code>--system</code> option</a>.
To query a specific setting, you can pass an argument to <code>--show-config</code>.</p>
<p>For example, to show the configuration of the <code>gpu</code> partition of the <code>example</code> system:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>reframe<span class="w"> </span>--system<span class="w"> </span>example:gpu<span class="w"> </span>--show-config<span class="w"> </span>systems/0/partitions
</code></pre></div>
<p>You can drill it down further to only show the value of a particular configuration setting.</p>
<p>For example, to only show the <code>launcher</code> value for the <code>gpu</code> partition of the <code>example</code> system:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>reframe<span class="w"> </span>--system<span class="w"> </span>example:gpu<span class="w"> </span>--show-config<span class="w"> </span>systems/0/partitions/@gpu/launcher
</code></pre></div>
<h2 id="how-to-write-a-reframe-configuration-file">How to write a ReFrame configuration file<a class="headerlink" href="#how-to-write-a-reframe-configuration-file" title="Permanent link">&para;</a></h2>
<p>The <a href="https://reframe-hpc.readthedocs.io/en/stable/configure.html">official ReFrame documentation</a> provides the full
description on configuring ReFrame for your site. However, there are some configuration settings that are specifically
required for the EESSI test suite. Also, there are a large amount of configuration settings available in ReFrame,
which makes the official documentation potentially a bit overwhelming.</p>
<p>Here, we will describe how to create a configuration file that works with the EESSI test suite, starting from an
<a href="https://github.com/EESSI/test-suite/tree/main/config/settings_example.py">example configuration file <code>settings_example.py</code></a>,
which defines the most common configuration settings.</p>
<h3 id="python-imports">Python imports<a class="headerlink" href="#python-imports" title="Permanent link">&para;</a></h3>
<p>The EESSI test suite standardizes a few string-based values as constants, as well as the logging format used by ReFrame.
Every ReFrame configuration file used for running the EESSI test suite should therefore start with the following import statements:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kn">from</span> <span class="nn">eessi.testsuite.common_config</span> <span class="kn">import</span> <span class="n">common_logging_config</span><span class="p">,</span> <span class="n">common_eessi_init</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="kn">from</span> <span class="nn">eessi.testsuite.constants</span> <span class="kn">import</span> <span class="o">*</span>
</code></pre></div>
<h3 id="high-level-system-info-systems">High-level system info (<code>systems</code>)<a class="headerlink" href="#high-level-system-info-systems" title="Permanent link">&para;</a></h3>
<p>First, we describe the system at its highest level through the
<a href="https://reframe-hpc.readthedocs.io/en/stable/config_reference.html#systems"><code>systems</code></a> keyword.</p>
<p>You can define multiple systems in a single configuration file (<code>systems</code> is a Python list value).
We recommend defining just a single system in each configuration file, as it makes the configuration file a bit easier to digest (for humans).</p>
<p>An example of the <code>systems</code> section of the configuration file would be:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">site_configuration</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>    <span class="s1">&#39;systems&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>    <span class="c1"># We could list multiple systems. Here, we just define one</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>        <span class="p">{</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;example&#39;</span><span class="p">,</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>            <span class="s1">&#39;descr&#39;</span><span class="p">:</span> <span class="s1">&#39;Example cluster&#39;</span><span class="p">,</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>            <span class="s1">&#39;modules_system&#39;</span><span class="p">:</span> <span class="s1">&#39;lmod&#39;</span><span class="p">,</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>            <span class="s1">&#39;hostnames&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">],</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>            <span class="s1">&#39;stagedir&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;/some/shared/dir/</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;USER&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">/reframe_output/staging&#39;</span><span class="p">,</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>            <span class="s1">&#39;partitions&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">...</span><span class="p">],</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>        <span class="p">}</span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>    <span class="p">]</span>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="p">}</span>
</code></pre></div>
<p>The most common configuration items defined at this level are:</p>
<ul>
<li><a href="https://reframe-hpc.readthedocs.io/en/stable/config_reference.html#config.systems.name"><code>name</code></a>:
  The name of the system. Pick whatever makes sense for you.</li>
<li><a href="https://reframe-hpc.readthedocs.io/en/stable/config_reference.html#config.systems.descr"><code>descr</code></a>:
  Description of the system. Again, pick whatever you like.</li>
<li><a href="https://reframe-hpc.readthedocs.io/en/stable/config_reference.html#config.systems.modules_system"><code>modules_system</code></a>:
  The modules system used on your system. EESSI provides modules in <code>lmod</code> format. There is no need to change this,
  unless you want to run tests from the EESSI test suite with non-EESSI modules.</li>
<li><a href="https://reframe-hpc.readthedocs.io/en/stable/config_reference.html#config.systems.hostnames"><code>hostnames</code></a>:
  The names of the hosts on which you will run the ReFrame command, as regular expression. Using these names,
  ReFrame can automatically determine which of the listed configurations in the <code>systems</code> list to use, which is useful
  if you're defining multiple systems in a single configuration file. If you follow our recommendation to limit
  yourself to one system per configuration file, simply define <code>'hostnames': ['*']</code>.</li>
<li><a href="https://reframe-hpc.readthedocs.io/en/stable/config_reference.html#config.systems.prefix"><code>prefix</code></a>:
  Prefix directory for a ReFrame run on this system. Any directories or files produced by ReFrame will use this prefix,
  if not specified otherwise.
  We recommend setting the <code>$RFM_PREFIX</code> environment variable rather than specifying <code>prefix</code> in
  your configuration file, so our <a href="#logging">common logging configuration</a> can pick up on it
  (see also <a href="#RFM_PREFIX"><code>$RFM_PREFIX</code></a>).</li>
<li><a href="https://reframe-hpc.readthedocs.io/en/stable/config_reference.html#config.systems.stagedir"><code>stagedir</code></a>: A shared directory that is available on all nodes that will execute ReFrame tests. This is used for storing (temporary) files related to the test. Typically, you want to set this to a path on a (shared) scratch filesystem. Defining this is optional: the default is a '<code>stage</code>' directory inside the <code>prefix</code> directory.</li>
<li><a href="https://reframe-hpc.readthedocs.io/en/stable/config_reference.html#config.systems.partitions"><code>partitions</code></a>: Details on system partitions, see below.</li>
</ul>
<h3 id="partitions">System partitions (<code>systems.partitions</code>)<a class="headerlink" href="#partitions" title="Permanent link">&para;</a></h3>
<p>The next step is to add the system partitions to the configuration files,
which is also specified as a Python list since a system can have multiple partitions.</p>
<p>The <a href="https://reframe-hpc.readthedocs.io/en/stable/config_reference.html#config.systems.partitions"><code>partitions</code></a>
section of the configuration for a system with two <a href="https://slurm.schedmd.com/">Slurm</a> partitions (one CPU partition,
and one GPU partition) could for example look something like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">site_configuration</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>    <span class="s1">&#39;systems&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>        <span class="p">{</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>            <span class="o">...</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>            <span class="s1">&#39;partitions&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>                <span class="p">{</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>                    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;cpu_partition&#39;</span><span class="p">,</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>                    <span class="s1">&#39;descr&#39;</span><span class="p">:</span> <span class="s1">&#39;CPU partition&#39;</span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>                    <span class="s1">&#39;scheduler&#39;</span><span class="p">:</span> <span class="s1">&#39;slurm&#39;</span><span class="p">,</span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>                    <span class="s1">&#39;prepare_cmds&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;source </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">common_eessi_init</span><span class="p">()],</span>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>                    <span class="s1">&#39;launcher&#39;</span><span class="p">:</span> <span class="s1">&#39;mpirun&#39;</span><span class="p">,</span>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>                    <span class="s1">&#39;access&#39;</span><span class="p">:</span>  <span class="p">[</span><span class="s1">&#39;-p cpu&#39;</span><span class="p">],</span>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>                    <span class="s1">&#39;environs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">],</span>
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>                    <span class="s1">&#39;max_jobs&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>                    <span class="s1">&#39;features&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a>                        <span class="n">FEATURES</span><span class="p">[</span><span class="n">CPU</span><span class="p">]</span>
<a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>                    <span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">SCALES</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span>
<a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a>                <span class="p">},</span>
<a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a>                <span class="p">{</span>
<a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a>                    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;gpu_partition&#39;</span><span class="p">,</span>
<a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a>                    <span class="s1">&#39;descr&#39;</span><span class="p">:</span> <span class="s1">&#39;GPU partition&#39;</span>
<a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a>                    <span class="s1">&#39;scheduler&#39;</span><span class="p">:</span> <span class="s1">&#39;slurm&#39;</span><span class="p">,</span>
<a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a>                    <span class="s1">&#39;prepare_cmds&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;source </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">common_eessi_init</span><span class="p">()],</span>
<a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a>                    <span class="s1">&#39;launcher&#39;</span><span class="p">:</span> <span class="s1">&#39;mpirun&#39;</span><span class="p">,</span>
<a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a>                    <span class="s1">&#39;access&#39;</span><span class="p">:</span>  <span class="p">[</span><span class="s1">&#39;-p gpu&#39;</span><span class="p">],</span>
<a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a>                    <span class="s1">&#39;environs&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">],</span>
<a id="__codelineno-6-27" name="__codelineno-6-27" href="#__codelineno-6-27"></a>                    <span class="s1">&#39;max_jobs&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
<a id="__codelineno-6-28" name="__codelineno-6-28" href="#__codelineno-6-28"></a>                    <span class="s1">&#39;resources&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-6-29" name="__codelineno-6-29" href="#__codelineno-6-29"></a>                        <span class="p">{</span>
<a id="__codelineno-6-30" name="__codelineno-6-30" href="#__codelineno-6-30"></a>                            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;_rfm_gpu&#39;</span><span class="p">,</span>
<a id="__codelineno-6-31" name="__codelineno-6-31" href="#__codelineno-6-31"></a>                            <span class="s1">&#39;options&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;--gpus-per-node=</span><span class="si">{num_gpus_per_node}</span><span class="s1">&#39;</span><span class="p">],</span>
<a id="__codelineno-6-32" name="__codelineno-6-32" href="#__codelineno-6-32"></a>                        <span class="p">}</span>
<a id="__codelineno-6-33" name="__codelineno-6-33" href="#__codelineno-6-33"></a>                    <span class="p">],</span>
<a id="__codelineno-6-34" name="__codelineno-6-34" href="#__codelineno-6-34"></a>                    <span class="s1">&#39;devices&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-6-35" name="__codelineno-6-35" href="#__codelineno-6-35"></a>                        <span class="p">{</span>
<a id="__codelineno-6-36" name="__codelineno-6-36" href="#__codelineno-6-36"></a>                            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">DEVICE_TYPES</span><span class="p">[</span><span class="n">GPU</span><span class="p">],</span>
<a id="__codelineno-6-37" name="__codelineno-6-37" href="#__codelineno-6-37"></a>                            <span class="s1">&#39;num_devices&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
<a id="__codelineno-6-38" name="__codelineno-6-38" href="#__codelineno-6-38"></a>                        <span class="p">}</span>
<a id="__codelineno-6-39" name="__codelineno-6-39" href="#__codelineno-6-39"></a>                    <span class="p">],</span>
<a id="__codelineno-6-40" name="__codelineno-6-40" href="#__codelineno-6-40"></a>                    <span class="s1">&#39;features&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-6-41" name="__codelineno-6-41" href="#__codelineno-6-41"></a>                        <span class="n">FEATURES</span><span class="p">[</span><span class="n">CPU</span><span class="p">],</span>
<a id="__codelineno-6-42" name="__codelineno-6-42" href="#__codelineno-6-42"></a>                        <span class="n">FEATURES</span><span class="p">[</span><span class="n">GPU</span><span class="p">],</span>
<a id="__codelineno-6-43" name="__codelineno-6-43" href="#__codelineno-6-43"></a>                    <span class="p">],</span>
<a id="__codelineno-6-44" name="__codelineno-6-44" href="#__codelineno-6-44"></a>                    <span class="s1">&#39;extras&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-6-45" name="__codelineno-6-45" href="#__codelineno-6-45"></a>                        <span class="n">GPU_VENDOR</span><span class="p">:</span> <span class="n">GPU_VENDORS</span><span class="p">[</span><span class="n">NVIDIA</span><span class="p">],</span>
<a id="__codelineno-6-46" name="__codelineno-6-46" href="#__codelineno-6-46"></a>                    <span class="p">},</span>
<a id="__codelineno-6-47" name="__codelineno-6-47" href="#__codelineno-6-47"></a>                <span class="p">},</span>
<a id="__codelineno-6-48" name="__codelineno-6-48" href="#__codelineno-6-48"></a>            <span class="p">]</span>
<a id="__codelineno-6-49" name="__codelineno-6-49" href="#__codelineno-6-49"></a>        <span class="p">}</span>
<a id="__codelineno-6-50" name="__codelineno-6-50" href="#__codelineno-6-50"></a>    <span class="p">]</span>
<a id="__codelineno-6-51" name="__codelineno-6-51" href="#__codelineno-6-51"></a><span class="p">}</span>
</code></pre></div>
<p>The most common configuration items defined at this level are:</p>
<ul>
<li><a href="https://reframe-hpc.readthedocs.io/en/stable/config_reference.html#config.systems.partitions.name"><code>name</code></a>:
  The name of the partition. Pick anything you like.</li>
<li><a href="https://reframe-hpc.readthedocs.io/en/stable/config_reference.html#config.systems.partitions.descr"><code>descr</code></a>:
  Description of the partition. Again, pick whatever you like.</li>
<li><a href="https://reframe-hpc.readthedocs.io/en/stable/config_reference.html#config.systems.partitions.scheduler"><code>scheduler</code></a>:
  The scheduler used to submit to this partition, for example <code>slurm</code>. All valid options can be found
  <a href="https://reframe-hpc.readthedocs.io/en/stable/config_reference.html#config.systems.partitions.scheduler">in the ReFrame documentation</a>.</li>
<li><a href="https://reframe-hpc.readthedocs.io/en/stable/config_reference.html#config.systems.partitions.launcher"><code>launcher</code></a>:
  The parallel launcher used on this partition, for example <code>mpirun</code> or <code>srun</code>. All valid options can be found
  <a href="https://reframe-hpc.readthedocs.io/en/stable/config_reference.html#config.systems.partitions.launcher">in the ReFrame documentation</a>.</li>
<li><a href="https://reframe-hpc.readthedocs.io/en/stable/config_reference.html#config.systems.partitions.access"><code>access</code></a>:
  A list of arguments that you would normally pass to the scheduler when submitting to this partition
  (for example '<code>-p cpu</code>' for submitting to a Slurm partition called <code>cpu</code>).
  If supported by your scheduler, we recommend to <em>not</em> export the submission environment
  (for example by using '<code>--export=None</code>' with Slurm). This avoids test failures due to environment variables set
  in the submission environment that are passed down to submitted jobs.</li>
<li><a href="https://reframe-hpc.readthedocs.io/en/stable/config_reference.html#config.systems.partitions.prepare_cmds"><code>prepare_cmds</code></a>:
  Commands to execute at the start of every job that runs a test. If your batch scheduler does not export
  the environment of the submit host, this is typically where you can initialize the EESSI environment.</li>
<li><a href="https://reframe-hpc.readthedocs.io/en/stable/config_reference.html#config.systems.partitions.environs"><code>environs</code></a>:
  The names of the <em>programming environments</em> (to be defined later in the configuration file via <a href="#environments"><code>environments</code></a>)
  that may be used on this partition. A programming environment is required for tests that are compiled first,
  before they can run. The EESSI test suite however only tests existing software installations, so no compilation
  (or specific programming environment) is needed. Simply specify <code>'environs': ['default']</code>,
  since ReFrame requires that <em>a</em> default environment is defined. </li>
<li><a href="https://reframe-hpc.readthedocs.io/en/stable/config_reference.html#config.systems.partitions.max_jobs"><code>max_jobs</code></a>:
  The maximum amount of jobs ReFrame is allowed to submit in parallel. Some batch systems limit how many jobs users
  are allowed to have in the queue. You can use this to make sure ReFrame doesn't exceed that limit.</li>
<li><a href="https://reframe-hpc.readthedocs.io/en/stable/config_reference.html#custom-job-scheduler-resources"><code>resources</code></a>:
  This field defines how additional resources can be requested in a batch job. Specifically, on a GPU partition,
  you have to define a resource with the name '<code>_rfm_gpu</code>'. The <code>options</code> field should then contain the argument to be
  passed to the batch scheduler in order to request a certain number of GPUs <em>per node</em>, which could be different for
  different batch schedulers. For example, when using Slurm you would specify:
  <div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="s1">&#39;resources&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>  <span class="p">{</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>      <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;_rfm_gpu&#39;</span><span class="p">,</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>      <span class="s1">&#39;options&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;--gpus-per-node=</span><span class="si">{num_gpus_per_node}</span><span class="s1">&#39;</span><span class="p">],</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>  <span class="p">},</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="p">],</span>
</code></pre></div></li>
<li><a href="https://reframe-hpc.readthedocs.io/en/stable/config_reference.html#config.systems.partitions.processor"><code>processor</code></a>:
  We recommend to <em>NOT</em> define this field, unless <a href="#cpu-auto-detection">CPU autodetection</a> is not working for you.
  The EESSI test suite relies on information about your processor topology to run. Using CPU autodetection is the
  easiest way to ensure that <em>all</em> processor-related information needed by the EESSI test suite are defined.
  Only if CPU autodetection is failing for you do we advice you to set the <code>processor</code> in the partition configuration
  as an alternative. Although additional fields might be used by future EESSI tests, at this point you'll have to
  specify <em>at least</em> the following fields:
  <div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="s1">&#39;processor&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>    <span class="s1">&#39;num_cpus&#39;</span><span class="p">:</span> <span class="mi">64</span><span class="p">,</span>  <span class="c1"># Total number of CPU cores in a node</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>    <span class="s1">&#39;num_sockets&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>  <span class="c1"># Number of sockets in a node</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>    <span class="s1">&#39;num_cpus_per_socket&#39;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>  <span class="c1"># Number of CPU cores per socket</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>    <span class="s1">&#39;num_cpus_per_core&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>  <span class="c1"># Number of hardware threads per CPU core</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="p">}</span>                 
</code></pre></div></li>
<li><a href="https://reframe-hpc.readthedocs.io/en/stable/config_reference.html#config.systems.partitions.features"><code>features</code></a>:
  The <code>features</code> field is used by the EESSI test suite to run tests <em>only</em> on a partition if it supports a certain
  <em>feature</em> (for example if GPUs are available). Feature names are standardized in the EESSI test suite in
  <a href="https://github.com/EESSI/test-suite/blob/main/eessi/testsuite/constants.py"><code>eessi.testsuite.constants.FEATURES</code></a>
  dictionary.
  Typically, you want to define <code>features: [FEATURES[CPU]] + list(SCALES.keys())</code> for CPU based partitions, and
  <code>features: [FEATURES[GPU]] + list(SCALES.keys())</code> for GPU based partitions. The first tells the EESSI test suite
  that this partition can only run CPU-based tests, whereas second indicates that this partition can only run GPU-based
  tests. You <em>can</em> define a single partition to have <em>both</em> the CPU and GPU features (since <code>features</code> is a Python list).
  However, since the CPU-based tests will not ask your batch scheduler for GPU resources, this <em>may</em> fail on batch
  systems that force you to ask for at least one GPU on GPU-based nodes. Also, running CPU-only code on a GPU node is
  typically considered bad practice, thus testing its functionality is typically not relevant.
  The <code>list(SCALES.keys())</code> adds all the scales that may be used by EESSI tests to the <code>features</code> list. These scales are
  defined in
  <a href="https://github.com/EESSI/test-suite/blob/main/eessi/testsuite/constants.py"><code>eessi.testsuite.constants.SCALES</code></a>
  and define at which scales tests should be run, e.g. single core, half a node, a full node, two nodes, etc. This
  can be used to exclude running at certain scales on systems that would not support it. E.g. some systems might not
  support requesting multiple partial nodes, which is what the <code>1_cpn_2_nodes</code> (1 core per node, on two nodes) and
  <code>1_cpn_4_nodes</code> scales do. One could exclude these by setting e.g.
  <code>features: [FEATURES[CPU]] + [s for s in SCALES if s not in ['1_cpn_2_nodes', '1_cpn_4_nodes']]</code>. With this
  configuration setting, ReFrame will run all the scales listed in `eessi.testsuite.constants.SCALES <em>except</em>
  those two. In a similar way, one could exclude all multinode tests if one just has a single node available.</li>
<li><a href="https://reframe-hpc.readthedocs.io/en/stable/config_reference.html#config.systems.partitions.devices"><code>devices</code></a>: This field specifies information on devices (for example) present in the partition. Device types are standardized in the EESSI test suite in the <a href="https://github.com/EESSI/test-suite/blob/main/eessi/testsuite/constants.py"><code>eessi.testsuite.constants.DEVICE_TYPES</code></a> dictionary. This is used by the EESSI test suite to determine how many of these devices it can/should use per node.
  Typically, there is no need to define <code>devices</code> for CPU partitions.
  For GPU partitions, you want to define something like:
  <div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="s1">&#39;devices&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">DEVICE_TYPES</span><span class="p">[</span><span class="n">GPU</span><span class="p">],</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>    <span class="s1">&#39;num_devices&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>  <span class="c1"># or however many GPUs you have per node</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="p">}</span>
</code></pre></div></li>
<li><a href="https://reframe-hpc.readthedocs.io/en/stable/config_reference.html#config.systems.partitions.extras"><code>extras</code></a>: This field specifies extra information on the partition, such as the GPU vendor. Valid fields for <code>extras</code> are standardized as constants in <a href="https://github.com/EESSI/test-suite/blob/main/eessi/testsuite/constants.py"><code>eessi.testsuite.constants</code></a> (for example <code>GPU_VENDOR</code>). This is used by the EESSI test suite to decide if a partition can run a test that <em>specifically</em> requires a certain brand of GPU.
  Typically, there is no need to define <code>extras</code> for CPU partitions.
  For GPU partitions, you typically want to specify the GPU vendor, for example:
  <div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="s1">&#39;extras&#39;</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>    <span class="n">GPU_VENDOR</span><span class="p">:</span> <span class="n">GPU_VENDORS</span><span class="p">[</span><span class="n">NVIDIA</span><span class="p">]</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="p">}</span>
</code></pre></div></li>
</ul>
<p>Note that as more tests are added to the EESSI test suite, the use of <code>features</code>, <code>devices</code> and <code>extras</code> by the EESSI test suite may be extended, which may require an update of your configuration file to define newly recognized fields.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Keep in mind that ReFrame partitions are <em>virtual</em> entities: they may or may not correspond to a partition as it is
configured in your batch system. One might for example have a single partition in the batch system, but configure
it as two separate partitions in the ReFrame configuration file based on additional constraints that are passed to
the scheduler, see for example the <a href="https://github.com/EESSI/test-suite/blob/main/config/aws_citc.py">AWS CitC example configuration</a>.</p>
<p>The EESSI test suite (and more generally, ReFrame) assumes the hardware <em>within</em> a partition defined in the ReFrame configuration file is <em>homogeneous</em>.</p>
</div>
<h3 id="environments">Environments<a class="headerlink" href="#environments" title="Permanent link">&para;</a></h3>
<p>ReFrame needs a programming environment to be defined in its configuration file for tests that need to be compiled before they are run. While we don't have such tests in the EESSI test suite, ReFrame requires <em>some</em> programming environment to be defined:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="n">site_configuration</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>    <span class="o">...</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>    <span class="s1">&#39;environments&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>        <span class="p">{</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>            <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;default&#39;</span><span class="p">,</span>  <span class="c1"># Note: needs to match whatever we set for &#39;environs&#39; in the partition</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>            <span class="s1">&#39;cc&#39;</span><span class="p">:</span> <span class="s1">&#39;cc&#39;</span><span class="p">,</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>            <span class="s1">&#39;cxx&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>            <span class="s1">&#39;ftn&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>        <span class="p">}</span>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a>    <span class="p">]</span>
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="p">}</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code>name</code> here needs to match whatever we specified for <a href="#partitions">the <code>environs</code> property of the partitions</a>.</p>
</div>
<h3 id="logging">Logging<a class="headerlink" href="#logging" title="Permanent link">&para;</a></h3>
<p>ReFrame allows a large degree of control over what gets logged, and where. For convenience, we have created a common logging
configuration in <a href="https://github.com/EESSI/test-suite/blob/main/eessi/testsuite/common_config.py"><code>eessi.testsuite.common_config</code></a>
that provides a reasonable default. It can be used by importing <code>common_logging_config</code> and calling it as a function
to define the '<code>logging</code> setting:
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="kn">from</span> <span class="nn">eessi.testsuite.common_config</span> <span class="kn">import</span> <span class="n">common_logging_config</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="n">site_configuration</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>    <span class="o">...</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>    <span class="s1">&#39;logging&#39;</span><span class="p">:</span>  <span class="n">common_logging_config</span><span class="p">(),</span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="p">}</span>
</code></pre></div>
When combined by setting the <a href="#RFM_PREFIX"><code>$RFM_PREFIX</code> environment variable</a>, the output, performance log, and
regular ReFrame logs will all end up in the directory specified by <code>$RFM_PREFIX</code>, which we recommend doing.</p>
<p>Alternatively, a prefix can be passed as an argument like <code>common_logging_config(prefix)</code>, which will control where
the regular ReFrame log ends up. Note that the performance logs do <em>not</em> respect this prefix: they will still end up
in the standard ReFrame prefix (by default the current directory, unless otherwise set with <code>$RFM_PREFIX</code> or <code>--prefix</code>).</p>
<h3 id="cpu-auto-detection">Auto-detection of processor information<a class="headerlink" href="#cpu-auto-detection" title="Permanent link">&para;</a></h3>
<p>You can let ReFrame <a href="https://reframe-hpc.readthedocs.io/en/stable/configure.html#proc-autodetection">auto-detect the processor information</a> for your system.</p>
<p>ReFrame will automatically use auto-detection when two conditions are met:</p>
<ol>
<li>The <a href="#partitions"><code>partitions</code> section of you configuration file</a> does <em>not</em> specify <code>processor</code> information for a
   particular partition (as per our recommendation <a href="#partitions">in the previous section</a>);</li>
<li>The <code>remote_detect</code> option is enabled in the <code>general</code> part of the configuration, as follows:
   <div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="n">site_configuration</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>    <span class="s1">&#39;systems&#39;</span><span class="p">:</span> <span class="o">...</span>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>    <span class="s1">&#39;logging&#39;</span><span class="p">:</span> <span class="o">...</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>    <span class="s1">&#39;general&#39;</span><span class="p">:</span> <span class="p">[</span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>        <span class="p">{</span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>            <span class="s1">&#39;remote_detect&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>        <span class="p">}</span>
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a>    <span class="p">]</span>
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="p">}</span>
</code></pre></div></li>
</ol>
<p>To trigger the auto-detection of processor information, it is sufficient to
let ReFrame list the available tests:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>reframe --list
</code></pre></div>
<p>ReFrame will store the processor information for your system in <code>~/.reframe/topology/&lt;system&gt;-&lt;partition&gt;/processor.json</code>.</p>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">February 14, 2024</span>
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/eessi_hpc" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["instant", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.081f42fc.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs" type="module"></script>
      
        <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
      
        <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
      
        <script src="../../available_software/javascripts/populate_overview.js"></script>
      
    
  </body>
</html>