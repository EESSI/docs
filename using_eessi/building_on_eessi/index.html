
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://eessi.github.io/docs/using_eessi/building_on_eessi/">
      
      
        <link rel="prev" href="../../filesystem_layer/stratum1/">
      
      
        <link rel="next" href="../../test-suite/">
      
      
      <link rel="icon" href="../../img/logos/EESSI.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.5">
    
    
      
        <title>Building software with EESSI - European Environment for Scientific Software Installations (EESSI)</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8608ea7d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#building-software-on-top-of-eessi" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="European Environment for Scientific Software Installations (EESSI)" class="md-header__button md-logo" aria-label="European Environment for Scientific Software Installations (EESSI)" data-md-component="logo">
      
  <img src="../../img/logos/EESSI.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            European Environment for Scientific Software Installations (EESSI)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Building software with EESSI
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/EESSI" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    EESSI @ GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="European Environment for Scientific Software Installations (EESSI)" class="md-nav__button md-logo" aria-label="European Environment for Scientific Software Installations (EESSI)" data-md-component="logo">
      
  <img src="../../img/logos/EESSI.png" alt="logo">

    </a>
    European Environment for Scientific Software Installations (EESSI)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/EESSI" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    EESSI @ GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Design
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Design
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Project overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../filesystem_layer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Filesystem layer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../compatibility_layer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Compatibility layer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../software_layer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Software layer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../software_layer/cpu_targets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Supported CPU targets
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Available software and repositories
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Available software and repositories
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../available_software/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Software
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Repositories
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Repositories
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../repositories/software.eessi.io/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Production
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../repositories/riscv.eessi.io/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RISC-V
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../repositories/pilot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pilot
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../repositories/dev.eessi.io/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Development repository
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Installation and configuration
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Installation and configuration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_access/is_eessi_accessible/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Is EESSI already installed?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_access/native_installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Native
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_access/eessi_container/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Container
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Windows and macOS
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Windows and macOS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_access/eessi_wsl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Windows with WSL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_access/eessi_limactl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    macOS with Lima
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Configuring EESSI
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            Configuring EESSI
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../site_specific_config/host_injections/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How to configure EESSI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../site_specific_config/gpu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GPU support
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../site_specific_config/lmod_hooks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Custom LMOD hooks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Basic usage
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Basic usage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../setting_up_environment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Set up environment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../basic_commands/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic commands
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eessi_demos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Demos
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eessi_in_ci/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EESSI in CI
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Advanced usage
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Advanced usage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../filesystem_layer/stratum1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setting up your Stratum
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Building software with EESSI
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Building software with EESSI
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#building-software-on-top-of-eessi-with-easybuild" class="md-nav__link">
    <span class="md-ellipsis">
      Building software on top of EESSI with EasyBuild
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Building software on top of EESSI with EasyBuild">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#starting-the-eessi-software-environment" class="md-nav__link">
    <span class="md-ellipsis">
      Starting the EESSI software environment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-the-eessi-extend-module" class="md-nav__link">
    <span class="md-ellipsis">
      Using the EESSI-extend module
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building" class="md-nav__link">
    <span class="md-ellipsis">
      Building
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-the-newly-built-module" class="md-nav__link">
    <span class="md-ellipsis">
      Using the newly built module
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#manually-building-software-on-top-of-eessi-without-easybuild" class="md-nav__link">
    <span class="md-ellipsis">
      Manually building software on top of EESSI (without EasyBuild)
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3" >
        
          
          <label class="md-nav__link" for="__nav_6_3" id="__nav_6_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Test suite
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3">
            <span class="md-nav__icon md-icon"></span>
            Test suite
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../test-suite/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../test-suite/installation-configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation & configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../test-suite/ReFrame-configuration-file/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ReFrame configuration file
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../test-suite/usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../test-suite/available-tests/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Available tests
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../test-suite/writing-portable-tests/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Writing tests
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../test-suite/release-notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Release notes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4" >
        
          
          <label class="md-nav__link" for="__nav_6_4" id="__nav_6_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Known issues and workarounds
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4">
            <span class="md-nav__icon md-icon"></span>
            Known issues and workarounds
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../known_issues/eessi-2023.06/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    v2023.06
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Adding software to EESSI
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Adding software to EESSI
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../adding_software/overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    For contributors
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            For contributors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../adding_software/contribution_policy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contribution policy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../adding_software/opening_pr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Open PR
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../adding_software/debugging_failed_builds/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Debugging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../adding_software/adding_development_software/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Development repository
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3" >
        
          
          <label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    For maintainers
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3">
            <span class="md-nav__icon md-icon"></span>
            For maintainers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BTD bot
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../adding_software/building_software/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building software
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../adding_software/deploying_software/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deploying software
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../software_layer/build_nodes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Build nodes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Community and support
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Community and support
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../support/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting support
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../meetings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Meetings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../talks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Talks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contact/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contact info
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../systems/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Systems where EESSI is available
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../governance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Governance
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../blog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#building-software-on-top-of-eessi-with-easybuild" class="md-nav__link">
    <span class="md-ellipsis">
      Building software on top of EESSI with EasyBuild
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Building software on top of EESSI with EasyBuild">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#starting-the-eessi-software-environment" class="md-nav__link">
    <span class="md-ellipsis">
      Starting the EESSI software environment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-the-eessi-extend-module" class="md-nav__link">
    <span class="md-ellipsis">
      Using the EESSI-extend module
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building" class="md-nav__link">
    <span class="md-ellipsis">
      Building
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-the-newly-built-module" class="md-nav__link">
    <span class="md-ellipsis">
      Using the newly built module
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#manually-building-software-on-top-of-eessi-without-easybuild" class="md-nav__link">
    <span class="md-ellipsis">
      Manually building software on top of EESSI (without EasyBuild)
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="building-software-on-top-of-eessi">Building software on top of EESSI<a class="headerlink" href="#building-software-on-top-of-eessi" title="Permanent link">&para;</a></h1>
<h2 id="building-software-on-top-of-eessi-with-easybuild">Building software on top of EESSI with EasyBuild<a class="headerlink" href="#building-software-on-top-of-eessi-with-easybuild" title="Permanent link">&para;</a></h2>
<p>Building on top of EESSI with EasyBuild is relatively straightforward. One crucial feature is that EasyBuild supports building against operating system libraries that are <em>not</em> in a standard prefix (such as <code>/usr/lib</code>). This is required when building against EESSI, since all of the software in EESSI is built against the <a href="../../compatibility_layer/">compatibility layer</a>.</p>
<h3 id="starting-the-eessi-software-environment">Starting the EESSI software environment<a class="headerlink" href="#starting-the-eessi-software-environment" title="Permanent link">&para;</a></h3>
<p>Start your environment as described <a href="../setting_up_environment/">here</a></p>
<h3 id="using-the-eessi-extend-module">Using the EESSI-extend module<a class="headerlink" href="#using-the-eessi-extend-module" title="Permanent link">&para;</a></h3>
<p>The <code>EESSI-extend</code> module facilitates building on top of EESSI using EasyBuild. It does a few key things:</p>
<ol>
<li>It configures EasyBuild to match how the rest of the EESSI software is built</li>
<li>It configures EasyBuild to use a certain installation path (e.g. in your homedir), taking into account the hardware architecture you are building on</li>
<li>It adds the relevant subdirectory from your installation path to your <code>MODULEPATH</code>, to make sure your newly installed modules are available</li>
<li>It loads the EasyBuild module</li>
</ol>
<p>The <code>EESSI-extend</code> module recognizes a few environment variables. To print an up-to-date list, check the module itself
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>module help EESSI-extend/2023.06-easybuild
</code></pre></div></p>
<p>The installation prefix is determined by <code>EESSI-extend</code> through the following logic:</p>
<ol>
<li>If <code>$EESSI_CVMFS_INSTALL</code> is set, software is installed in <code>$EESSI_SOFTWARE_PATH</code>. This variable shouldn't be used by users and would only be used by CVMFS administrators of the EESSI repository.</li>
<li>If <code>$EESSI_SITE_INSTALL</code> is set, the EESSI site installation prefix (<code>$EESSI_SITE_SOFTWARE_PATH</code>) will be used. This is typically where sites hosting a system that has EESSI deployed would install additional software on top of EESSI and make it available to all their users.</li>
<li>If <code>$EESSI_PROJECT_INSTALL</code> is set (and <code>$EESSI_USER_INSTALL</code> is not set), this prefix will be used. You should use this if you want to install additional software on top of EESSI that should also be usable by your project partners on the same system. For example, if you have a project space at <code>/project/my_project</code> that all your project partners can access, you could set <code>export EESSI_PROJECT_INSTALL=/project/my_project/eessi</code>. Make sure that this directory has the SGID permission set (<code>chmod g+s $EESSI_PROJECT_INSTALL</code>). This way, all the additional installations done with <code>EESSI-extend</code> will be put in that prefix, and will get the correct UNIX file permissions so that all your project partners can access it.</li>
<li>If <code>$EESSI_USER_INSTALL</code> is set, this prefix will be used. You should use this if you want to install additional software on top of EESSI just for your own user. For example, you could set <code>export EESSI_USER_INSTALL=$HOME/my/eessi/extend/prefix</code>, and <code>EESSI-extend</code> will install all software in this prefix. Unix file permissions will be set such that these installations will be readable only to the user.</li>
</ol>
<p>If none of the above apply, the default is a user installation in <code>$HOME/EESSI</code> (i.e. effectively the same as setting <code>EESSI_USER_INSTALL=$HOME/EESSI</code>).</p>
<p>Here, we assume you are just an end-user, not having set any of the above environment variables, and loading the <code>EESSI-extend</code> module with the default installation prefix:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>module load EESSI-extend/2023.06-easybuild
</code></pre></div>
<p>Now, if we check the EasyBuild configuration</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>eb --show-config
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>allow-loaded-modules (E) = EasyBuild, EESSI-extend
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>buildpath            (E) = /tmp/&lt;user&gt;/easybuild/build
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>containerpath        (E) = /tmp/&lt;user&gt;/easybuild/containers
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>debug                (E) = True
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>experimental         (E) = True
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>filter-deps          (E) = Autoconf, Automake, Autotools, binutils, bzip2, DBus, flex, gettext, gperf, help2man, intltool, libreadline, libtool, M4, makeinfo, ncurses, util-linux, XZ, zlib
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>filter-env-vars      (E) = LD_LIBRARY_PATH
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>hooks                (E) = /cvmfs/software.eessi.io/versions/2023.06/init/easybuild/eb_hooks.py
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>ignore-osdeps        (E) = True
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>installpath          (E) = /home/&lt;user&gt;/eessi/versions/2023.06/software/linux/x86_64/amd/zen2
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>module-extensions    (E) = True
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>packagepath          (E) = /tmp/&lt;user&gt;/easybuild/packages
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>prefix               (E) = /tmp/&lt;user&gt;/easybuild
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>read-only-installdir (E) = True
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>repositorypath       (E) = /tmp/&lt;user&gt;/easybuild/ebfiles_repo
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>robot-paths          (D) = /cvmfs/software.eessi.io/versions/2023.06/software/linux/x86_64/amd/zen2/software/EasyBuild/4.9.4/easybuild/easyconfigs
<a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>rpath                (E) = True
<a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a>sourcepath           (E) = /tmp/&lt;user&gt;/easybuild/sources
<a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>sticky-bit           (E) = True
<a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>sysroot              (E) = /cvmfs/software.eessi.io/versions/2023.06/compat/linux/x86_64
<a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a>trace                (E) = True
<a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a>umask                (E) = 077
<a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a>zip-logs             (E) = bzip2
</code></pre></div>
<p>Apart from the <code>installpath</code>, this is exactly how EasyBuild is configured when software is built for EESSI itself.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Be aware that <code>EESSI-extend</code> will optimize the installation for your current hardware architecture, and the <code>installpath</code> also contains this architecture in it's directory structure (just like regular EESSI installations do). This means you should run the installation on the node type on which you also want to use the software. If you want the installation to be present for multiple node types, you can simply run it once on each type of node.</p>
</div>
<p>And, if we check our <code>MODULEPATH</code>, we see that the <code>installpath</code> that EasyBuild will use here is prepended
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>$ echo $MODULEPATH
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>/home/&lt;user&gt;/eessi/versions/2023.06/software/linux/x86_64/amd/zen2/modules/all:...
</code></pre></div></p>
<h3 id="building">Building<a class="headerlink" href="#building" title="Permanent link">&para;</a></h3>
<p>Now, you are ready to build. For example, suppose you want to install <code>netcdf4-python-1.6.5-foss-2023b.eb</code> (which is not present at the time of writing), you run:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>eb netcdf4-python-1.6.5-foss-2023b.eb
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If this netCDF for python module is available by the time you are trying, you can force a local rebuild by adding the <code>--rebuild</code> argument in order to experiment with building locally, or pick a different EasyConfig to build.</p>
</div>
<h3 id="using-the-newly-built-module">Using the newly built module<a class="headerlink" href="#using-the-newly-built-module" title="Permanent link">&para;</a></h3>
<p>If the installation was done in the site installation path (i.e. <code>EESSI_SITE_INSTALL</code> was set, and things were installed in <code>/cvmfs/software.eessi.io/host_injections/...</code>), the modules are available by default to anyone who has initialized the EESSI software environment.</p>
<p>If the installation through <code>EESSI-extend</code> was done in a <code>EESSI_PROJECT_INSTALL</code> or <code>EESSI_USER_INSTALL</code> location, one has to make sure to load the <code>EESSI-extend</code> module before loading the module of interest, since this adds those prefixes to the <code>MODULEPATH</code>.</p>
<p>If we don't have the <code>EESSI-extend</code> module loaded, it will not find any modules installed in the <code>EESSI_PROJECT_INSTALL</code> or <code>EESSI_USER_INSTALL</code> locations:
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>$ module unload EESSI-extend
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>$ module av netcdf4-python/1.6.5-foss-2023b
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>No module(s) or extension(s) found!
</code></pre></div></p>
<p>But, if we load <code>EESSI-extend</code> first:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>$ module load EESSI-extend/2023.06-easybuild
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>$ module av netcdf4-python/1.6.5-foss-2023b
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>---- /home/&lt;user&gt;/eessi/versions/2023.06/software/linux/x86_64/amd/zen2/modules/all ----
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>   netcdf4-python/1.6.5-foss-2023b
</code></pre></div>
<p>This means you'll <em>always</em> need to load the <code>EESSI-extend</code> module if you want to use these modules (also, and particularly when you want to use them in a job script).</p>
<h2 id="manually-building-software-on-top-of-eessi-without-easybuild">Manually building software on top of EESSI (without EasyBuild)<a class="headerlink" href="#manually-building-software-on-top-of-eessi-without-easybuild" title="Permanent link">&para;</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>We are working on a module file that should make building on top of EESSI (without using EasyBuild)
more straightforward, particularly when using <code>Autotools</code> or <code>CMake</code>. Right now, it is a little convoluted
and requires you to have a decent grasp of
* What a runtime dynamic linker (<code>ld-linux*.so</code>) is and does
* How to influence the behaviour of the runtime linker with <code>LD_LIBRARY_PATH</code>
* The difference between <code>LIBRARY_PATH</code> and <code>LD_LIBRARY_PATH</code></p>
<p>As such, this documentation is intended for "experts" in the runtime linker and it's behaviour,
and most cases are untested. Any feedback on this topic is highly appreciated. </p>
</div>
<p>Building and running software on top of EESSI without EasyBuild is not straightforward and requires some considerations to take care of. </p>
<p>It is expected that you will have loaded all of your required dependencies as modules from the EESSI environment. Since EESSI sets
<code>LIBRARY_PATH</code> for all of the modules and the <code>GCC</code> compiler is configured to use the compat layer, there should be no additional configuration
required to execute a standard build process. On the other hand, EESSI does not set <code>LD_LIBRARY_PATH</code> so, <em>at runtime</em>, the executable will need help
finding the libraries that it needs to actually execute. The easiest way to circumvent this requirement is by setting the environment variable <code>LD_RUN_PATH</code>
during compile time as well. With <code>LD_RUN_PATH</code> set, the program will be able to tell the dynamic linker to search in those paths when the program is being
executed. </p>
<p>EESSI uses a <a href="../../compatibility_layer/">compatibility layer</a> to ensure that it takes as few libraries from the host as possible. The safest way to make sure
all libraries will point to the required locations in the compatibility layer (and do not leak in from the host operating system) is starting an EESSI prefix
shell before building. To do this: </p>
<ul>
<li>First of all, load the environment by starting an EESSI shell as described <a href="https://www.eessi.io/docs/using_eessi/setting_up_environment">here</a>. </li>
<li>Load all dependencies you need to build your software. You must use at least a toolchain from EESSI to compile it (<code>foss</code> is a good option as it will also
  include MPI with OpenMPI and math libraries via FlexiBLAS/FFTW). </li>
<li>Set manually <code>LD_RUN_PATH</code> to resolve libraries at runtime. <code>LIBRARY_PATH</code> should contain all the paths we need, and we also need to include the path to
  <code>libstdc++</code> from our GCC installation to avoid picking up the one from the host:
  <div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="w">    </span><span class="nb">export</span><span class="w"> </span><span class="nv">LD_RUN_PATH</span><span class="o">=</span><span class="nv">$LIBRARY_PATH</span>:<span class="nv">$EBROOTGCCCORE</span>/lib64
</code></pre></div></li>
<li>
<p>Compile and make sure the library resolution points to the EESSI stack. For this, <code>ldd</code> from compatibility layer and <strong>not</strong> <code>/usr/bin/ldd</code> should be used
  when checking the binary.</p>
</li>
<li>
<p>Run! </p>
</li>
</ul>
<p>To exemplify this, take the classic MPI Hello World example code:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>/*The Parallel Hello World Program*/
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>#include &lt;stdio.h&gt;
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>#include &lt;mpi.h&gt;
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>int main(int argc, char **argv)
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>{
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>   int node;
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>   MPI_Init(&amp;argc,&amp;argv);
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>   MPI_Comm_rank(MPI_COMM_WORLD, &amp;rank);
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>   printf(&quot;Hello World from MPI rank %d\n&quot;, rank);
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a>   MPI_Finalize();
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>}
</code></pre></div>
<p>As described in the steps above, prepare the environment and load the required dependencies. For this case, we will use <code>gompi/2023b</code> as the toolchain to compile it.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a># Starting the environment
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>$ source /cvmfs/software.eessi.io/versions/2023.06/init/bash
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a># Loading the toolchain
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>{EESSI 2023.06} $ module load gompi/2023b
</code></pre></div>
<p>Now, set the <code>LD_RUN_PATH</code> environment variable for all the libraries to point to the runtime libraries, then compile the code.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a># Setting LD_RUN_PATH
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>{EESSI 2023.06}$ export LD_RUN_PATH=$LIBRARY_PATH:$EBROOTGCCCORE/lib64
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a># Compile the code manually
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>{EESSI 2023.06} $ mpicc -o HelloWorld mpi.c
</code></pre></div>
<p>This is the moment to check if the compiler picked all the libraries from the software and compatibility layer, not the host.</p>
<p>Look at the difference on the library solving when using the compatibility layer ldd from the host one:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c1"># ldd from the compatibility layer, notice how all libraries are resolved from the software layer -&gt; &quot;/cvmfs/software.eessi.io/versions/2023.06/software&quot;, the libc and the interpreter point to the compatibility layer, so all good to go!</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="o">{</span>EESSI<span class="w"> </span><span class="m">2023</span>.06<span class="o">}</span><span class="w"> </span>$<span class="w"> </span>ldd<span class="w"> </span>HelloWorld
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="w">    </span>linux-vdso.so.1<span class="w"> </span><span class="o">(</span>0x00007ffce03af000<span class="o">)</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="w">    </span>libmpi.so.40<span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>/cvmfs/software.eessi.io/versions/2023.06/software/linux/x86_64/intel/skylake_avx512/software/OpenMPI/4.1.6-GCC-13.2.0/lib/libmpi.so.40<span class="w"> </span><span class="o">(</span>0x00007fadd9e84000<span class="o">)</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="w">    </span>libc.so.6<span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>/cvmfs/software.eessi.io/versions/2023.06/compat/linux/x86_64/lib64/libc.so.6<span class="w"> </span><span class="o">(</span>0x00007fadd9ca8000<span class="o">)</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="o">[</span>...<span class="o">]</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="w">    </span>libevent_pthreads-2.1.so.7<span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>/cvmfs/software.eessi.io/versions/2023.06/software/linux/x86_64/intel/skylake_avx512/software/libevent/2.1.12-GCCcore-13.2.0/lib64/libevent_pthreads-2.1.so.7<span class="w"> </span><span class="o">(</span>0x00007fadd98f0000<span class="o">)</span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="w">    </span>libm.so.6<span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>/cvmfs/software.eessi.io/versions/2023.06/compat/linux/x86_64/lib/../lib64/libm.so.6<span class="w"> </span><span class="o">(</span>0x00007fadd9810000<span class="o">)</span>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="w">    </span>/cvmfs/software.eessi.io/versions/2023.06/compat/linux/x86_64/lib64/ld-linux-x86-64.so.2<span class="w"> </span><span class="o">(</span>0x00007fadd9fab000<span class="o">)</span>
</code></pre></div>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c1"># ldd from the host, even though the libraries point to the software layer, now the linker ld-linux-x86-64.so.2 from the compat layer directly points to &quot;/lib64/ld-linux-x86-64.so.2&quot; from the host to do the resolving, resulting in the GLIBC mismatch as libc is also resolved in the host and not the compat layer</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="o">{</span>EESSI<span class="w"> </span><span class="m">2023</span>.06<span class="o">}</span><span class="w"> </span>$<span class="w"> </span>/usr/bin/ldd<span class="w"> </span>HelloWorld
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>./HelloWorld:<span class="w"> </span>/lib64/libc.so.6:<span class="w"> </span>version<span class="w"> </span><span class="sb">`</span>GLIBC_2.36<span class="s1">&#39; not found (required by /cvmfs/software.eessi.io/versions/2023.06/software/linux/x86_64/intel/skylake_avx512/software/libevent/2.1.12-GCCcore-13.2.0/lib64/libevent_core-2.1.so.7)</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="s1">./HelloWorld: /lib64/libc.so.6: version `GLIBC_ABI_DT_RELR&#39;</span><span class="w"> </span>not<span class="w"> </span>found<span class="w"> </span><span class="o">(</span>required<span class="w"> </span>by<span class="w"> </span>/cvmfs/software.eessi.io/versions/2023.06/compat/linux/x86_64/lib/../lib64/libm.so.6<span class="o">)</span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="w">    </span>linux-vdso.so.1<span class="w"> </span><span class="o">(</span>0x00007fffe4fd3000<span class="o">)</span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="w">    </span>libmpi.so.40<span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>/cvmfs/software.eessi.io/versions/2023.06/software/linux/x86_64/intel/skylake_avx512/software/OpenMPI/4.1.6-GCC-13.2.0/lib/libmpi.so.40<span class="w"> </span><span class="o">(</span>0x00007f1fdf571000<span class="o">)</span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="w">    </span>libc.so.6<span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>/lib64/libc.so.6<span class="w"> </span><span class="o">(</span>0x00007f1fdf200000<span class="o">)</span>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="w">    </span><span class="o">[</span>...<span class="o">]</span>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="w">    </span>libevent_pthreads-2.1.so.7<span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>/cvmfs/software.eessi.io/versions/2023.06/software/linux/x86_64/intel/skylake_avx512/software/libevent/2.1.12-GCCcore-13.2.0/lib64/libevent_pthreads-2.1.so.7<span class="w"> </span><span class="o">(</span>0x00007f1fdf420000<span class="o">)</span>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="w">    </span>libm.so.6<span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>/cvmfs/software.eessi.io/versions/2023.06/compat/linux/x86_64/lib/../lib64/libm.so.6<span class="w"> </span><span class="o">(</span>0x00007f1fdeeb1000<span class="o">)</span>
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="w">    </span>/cvmfs/software.eessi.io/versions/2023.06/compat/linux/x86_64/lib64/ld-linux-x86-64.so.2<span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span>/lib64/ld-linux-x86-64.so.2<span class="w"> </span><span class="o">(</span>0x00007f1fdf698000<span class="o">)</span>
</code></pre></div>
Now is the moment of truth, if everything looks right when checking with ldd, you should be fine to run the program:</p>
<p><div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>{EESSI 2023.06} $ mpirun -n 2 HelloWorld
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>Hello World from Node 0
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>Hello World from Node 1
</code></pre></div>
Even when closing the shell and restarting the environment, the libraries should point to the directories we set in <code>LD_RUN_PATH</code>, still, remember to load the required dependencies before running the binary.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>RPATH should never point to a compatibility layer directory, only to software layer ones, as all resolving is done via the runtime linker (<code>ld-linux*.so</code>)
that is shipped with EESSI, which automatically searches these locations.</p>
</div>
<p>The biggest downside of this approach is that your executable becomes bound to the architecture you linked your libraries for, i.e., if you add to your executable RPATH a <code>libhdf5.so</code>compiled for <code>intel_avx512</code>, you will not be able to run that binary on a machine with a different architecture. If this is an issue for you, you should look into how EESSI itself organises the location of binaries and perhaps leverage the relevant environment variables (e.g., <code>EESSI_SOFTWARE_SUBDIR</code>).</p>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">January 30, 2025</span>
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/eessi_hpc" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["instant", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs" type="module"></script>
      
        <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
      
        <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
      
        <script src="../../available_software/javascripts/populate_overview.js"></script>
      
    
  </body>
</html>